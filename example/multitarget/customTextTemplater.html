<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Programmatic defining multiple intro texts to serve different target audiences (JSON), now with user-defined formatter callback</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Intro.js - Better introductions for websites and features with a step-by-step guide for your projects.">
    <meta name="author" content="Afshin Mehrabani (@afshinmeh) in usabli.ca group">

    <!-- styles -->
    <link href="../assets/css/bootstrap.css" rel="stylesheet">
    <link href="../assets/css/demo.css" rel="stylesheet">

    <!-- Add IntroJs styles -->
    <link href="../../introjs.css" rel="stylesheet">

    <style>
.introjs-tooltiptext h2 {
  font-size: 24px;
  padding: 2px;
}

.role-user {
  background-color: #D5B7FF;
  color: white;
}
.role-tester {
  background-color: #FFC5B0;
  color: white;
}
.role-admin {
  background-color: #ABFC88;
  color: white;
}
.role-default {
  background-color: #B3ECFF;
  color: white;
}
.role-unknown {
  background-color: #70F868;
  color: white;
}


.btn-info.active
{
  background-color: #DE5B5B;
  border-color: #DA4646;
}    
    </style>
  </head>

  <body>

    <div class="container-narrow">

      <div class="masthead">
        <ul id="step5" class="nav nav-pills pull-right">
          <li><a href="https://github.com/usablica/intro.js/tags"><i class='icon-black icon-download-alt'></i> Download</a></li>
          <li><a href="https://github.com/usablica/intro.js">Github</a></li>
          <li><a href="https://twitter.com/usablica">@usablica</a></li>
        </ul>
        <h3 class="muted">Intro.js</h3>
      </div>

      <hr>

      <div class="jumbotron">
        <h1 id="step1">Programmatic</h1>
        <p id="step4" class="lead">In this example we are going to define steps with JSON configuration.</p>
        <a class="btn btn-large btn-success" href="javascript:void(0);" onclick="startIntro();">Show me how</a>
        <hr>
        <p>Pick a user role:</p>
        <a class="btn btn-large btn-info" href="javascript:void(0);" onclick="setRole(this, null);">No role</a>
        <a class="btn btn-large btn-info" href="javascript:void(0);" onclick="setRole(this, 'user');">User</a>
        <a class="btn btn-large btn-info" href="javascript:void(0);" onclick="setRole(this, 'tester');">Tester</a>
        <a class="btn btn-large btn-info" href="javascript:void(0);" onclick="setRole(this, 'admin');">Admin</a>
        <hr>
        <a class="btn btn-large btn-info" href="javascript:void(0);" onclick="setRole(this, ['user', 'tester']);">User &amp; Tester both!</a>
        <a class="btn btn-large btn-info" href="javascript:void(0);" onclick="setRole(this, ['user', 'tester', 'admin']);">All these roles!</a>
        <hr>
        <a class="btn btn-large btn-info" href="javascript:void(0);" onclick="setRole(this, ['saint']);">The Unattainable Role: <i>Saint</i></a>
      </div>

      <hr>

      <div class="row-fluid marketing">
        <div id="step2" class="span6">
          <h4>Section One</h4>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis mollis augue a neque cursus ac blandit orci faucibus. Phasellus nec metus purus.</p>

          <h4>Section Two</h4>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis mollis augue a neque cursus ac blandit orci faucibus. Phasellus nec metus purus.</p>

          <h4>Section Three</h4>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis mollis augue a neque cursus ac blandit orci faucibus. Phasellus nec metus purus.</p>
        </div>

        <div id="step3" class="span6">
          <h4>Section Four</h4>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis mollis augue a neque cursus ac blandit orci faucibus. Phasellus nec metus purus.</p>


          <h4>Section Five</h4>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis mollis augue a neque cursus ac blandit orci faucibus. Phasellus nec metus purus.</p>

          <h4>Section Six</h4>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis mollis augue a neque cursus ac blandit orci faucibus. Phasellus nec metus purus.</p>
        </div>
      </div>

      <hr>

    </div>
    <script type="text/javascript" src="../../intro.js"></script>
    <script type="text/javascript">
      var intro;
      function startIntro(){
        if (!intro) {
          intro = introJs();
        }
        intro.setOptions({
            steps: [
              {
                element: document.querySelector('#step1'),
                intro: "Pick a user role to see different tooltip contents."
              },
              {
                element: document.querySelectorAll('#step2')[0],
                intro: {
                  user: "Hi User, this is specifically written for you! Great, uh?",
                  tester: "Hello Tester, are you just looking at this or coming up with new ways to break the code?",
                  admin: "Whoops. I bet <a target='_blank' href='http://bofh.ntk.net/BOFH/index.php'>this is you</a>. So sorry to bother you. It won't happen again, I swear!",
                  default: "You've got no role! If we hadn't supplied a <code>default</code> entry here your developer would have seen an exception and you would be staring at a b0rked screen!"
                },
                position: 'right'
              },
              {
                element: '#step3',
                intro: {
                  user: "<a target='_blank' href='http://www.collectedcurios.com/sequentialart.php?s=605'>We appreciate our users the mostest</a>, so they get special treatment.",
                  default: "Only <b>users</b> receive special attention; you will have to do with this generic entry."
                },
                position: 'left'
              },
              {
                element: '#step4',
                intro: {
                  default: "Another step. You got the <b>default</b> as does everybody else because this entry addresses an unattainable 'role'.",
                  saint: "&lt;bow&gt;"
                },
                position: 'bottom'
              },
              {
                element: '#step5',
                intro: 'Get it, use it.'
              }
            ],
            textTemplateCallback: function (roleAndText, index, collectedIntroTexts) {
              // we include both a HR separator between entries...
              var msg = [];
              if (index > 0) {
                msg.push('<hr class="intro-role-text-separator"/>');
              }
              // ... and provide a H2 HEADING for each ROLE if we are showing ANY ROLE BUT 'user' as part of the set:
              var only_user = true;
              for (var i in collectedIntroTexts) {
                if (collectedIntroTexts[i].user !== 'user') {
                  only_user = false;
                  break;
                }
              }
              var h2 = {
                user: "<h2 class='role-user'>User</h2>",
                tester: "<h2 class='role-tester'>Tester</h2>",
                admin: "<h2 class='role-admin'>Administrator</h2>",
                default: "<h2 class='role-default'>(default)</h2>",
                // we purposely 'forget' the 'unattainable' role of 'saint' in this list to demo the fallback to 'unknown' in the code below.
                unknown: "<h2 class='role-unknown'>Are you a saint???</h2>"
              }
              if (!only_user) {
                msg.push(h2[roleAndText.role] || h2['unknown']);
              }
              msg.push(roleAndText.text);
              return msg.join("\n");
            }
        });

        intro.start();
      }

      function setRole(currentElement, roles) {
        var els = document.querySelectorAll('.btn-info');
        for (var i = 0; i < els.length; i++) {
          var el = els[i];
          el.classList.remove('active');
        }
        currentElement.classList.add('active');

        if (!intro) {
          intro = introJs();
        }
        intro.setOption('activeRoles', roles);
      }
    </script>
  </body>
</html>
